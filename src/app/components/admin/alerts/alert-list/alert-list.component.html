<div class="alert-list-page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-left">
      <h1>ğŸš¨ Gestion des Alertes</h1>
      <p>{{ totalAlerts }} alerte(s) au total</p>
    </div>
    <div class="header-actions">
      <button (click)="loadAlerts()" class="btn-refresh" [disabled]="loading">
        ğŸ”„ Actualiser
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-card">
    <div class="filter-row">
      <div class="filter-group">
        <label>ğŸ” Vache ID</label>
        <input
          type="number"
          [(ngModel)]="searchCowId"
          placeholder="ID de la vache..."
          class="filter-input"
        />
      </div>

      <div class="filter-group">
        <label>ğŸ“Š SÃ©vÃ©ritÃ©</label>
        <select [(ngModel)]="selectedSeverity" class="filter-select">
          <option value="ALL">Toutes</option>
          <option value="CRITICAL">ğŸ”´ Critique</option>
          <option value="WARNING">âš ï¸ Avertissement</option>
          <option value="INFO">â„¹ï¸ Info</option>
        </select>
      </div>

      <div class="filter-group">
        <label>ğŸ¯ Statut</label>
        <select [(ngModel)]="selectedStatus" class="filter-select">
          <option value="ALL">Tous</option>
          <option value="NEW">ğŸ†• Nouvelles</option>
          <option value="ACKNOWLEDGED">ğŸ‘ï¸ AcquittÃ©es</option>
          <option value="IN_PROGRESS">â³ En cours</option>
          <option value="RESOLVED">âœ… RÃ©solues</option>
          <option value="ESCALATED">ğŸš¨ EscaladÃ©es</option>
        </select>
      </div>

      <div class="filter-group">
        <label>ğŸ·ï¸ Type</label>
        <select [(ngModel)]="selectedType" class="filter-select">
          <option value="ALL">Tous</option>
          <option value="TEMPERATURE">ğŸŒ¡ï¸ TempÃ©rature</option>
          <option value="HEART_RATE">ğŸ’“ Rythme cardiaque</option>
          <option value="INACTIVITY">ğŸ˜´ InactivitÃ©</option>
          <option value="BATTERY">ğŸ”‹ Batterie</option>
          <option value="PREDICTION">ğŸ¤– PrÃ©diction</option>
        </select>
      </div>

      <div class="filter-group">
        <button (click)="applyFilters()" class="btn-apply-filters">
          ğŸ” Appliquer
        </button>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des alertes...</p>
  </div>

  <!-- Alerts List -->
  <div *ngIf="!loading" class="alerts-container">
    <div *ngFor="let alert of filteredAlerts"
         class="alert-card"
         [class]="getSeverityClass(alert.severity)">

      <!-- Alert Header -->
      <div class="alert-header">
        <div class="alert-icon">
          {{ getSeverityIcon(alert.severity) }}
        </div>
        <div class="alert-title">
          <h3>{{ getTypeLabel(alert.type) }}</h3>
          <span class="alert-id">Alerte #{{ alert.id }}</span>
        </div>
        <div class="alert-badges">
          <span [class]="getStatusClass(alert.status)" class="status-badge">
            {{ getStatusLabel(alert.status) }}
          </span>
        </div>
      </div>

      <!-- Alert Content -->
      <div class="alert-content">
        <div class="alert-info-grid">
          <div class="info-item">
            <span class="info-label">ğŸ„ Vache ID:</span>
            <span class="info-value">{{ alert.cow_id }}</span>
          </div>

          <div class="info-item" *ngIf="alert.measured_value !== null">
            <span class="info-label">ğŸ“Š Valeur mesurÃ©e:</span>
            <span class="info-value">{{ alert.measured_value }}</span>
          </div>

          <div class="info-item" *ngIf="alert.threshold_value !== null">
            <span class="info-label">âš ï¸ Seuil:</span>
            <span class="info-value">{{ alert.threshold_value }}</span>
          </div>

          <div class="info-item">
            <span class="info-label">ğŸ“… Date:</span>
            <span class="info-value">{{ alert.created_at | date: 'dd/MM/yyyy HH:mm' }}</span>
          </div>
        </div>

        <div class="alert-message">
          <strong>Message:</strong> {{ alert.message }}
        </div>

        <!-- Acknowledged Info -->
        <div *ngIf="alert.acknowledged_at" class="alert-meta">
          <p>ğŸ‘ï¸ AcquittÃ©e le {{ alert.acknowledged_at | date: 'dd/MM/yyyy HH:mm' }}</p>
        </div>

        <!-- Resolved Info -->
        <div *ngIf="alert.resolved_at" class="alert-meta resolved">
          <p>âœ… RÃ©solue le {{ alert.resolved_at | date: 'dd/MM/yyyy HH:mm' }}</p>
          <p *ngIf="alert.resolution_notes"><strong>Notes:</strong> {{ alert.resolution_notes }}</p>
        </div>
      </div>

      <!-- Alert Actions -->
      <div class="alert-actions">
        <button
          [routerLink]="['/admin/alerts', alert.id]"
          class="btn-action view"
          title="Voir dÃ©tails">
          ğŸ‘ï¸ DÃ©tails
        </button>

        <button
          *ngIf="canAcknowledge(alert)"
          (click)="acknowledgeAlert(alert)"
          class="btn-action acknowledge"
          title="Acquitter">
          âœ“ Acquitter
        </button>

        <button
          *ngIf="canResolve(alert)"
          (click)="resolveAlert(alert)"
          class="btn-action resolve"
          title="RÃ©soudre">
          âœ… RÃ©soudre
        </button>

        <button
          (click)="deleteAlert(alert)"
          class="btn-action delete"
          title="Supprimer">
          ğŸ—‘ï¸
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && filteredAlerts.length === 0" class="empty-state">
    <div class="empty-icon">ğŸ‰</div>
    <p>Aucune alerte trouvÃ©e</p>
    <small>Tout va bien dans votre ferme !</small>
  </div>

  <!-- Pagination -->
  <div *ngIf="!loading && totalAlerts > pageSize" class="pagination">
    <button
      class="btn-page"
      (click)="previousPage()"
      [disabled]="currentPage === 1">
      â† PrÃ©cÃ©dent
    </button>

    <span class="page-info">
      Page {{ currentPage }} sur {{ totalPages }} ({{ totalAlerts }} alerte(s))
    </span>

    <button
      class="btn-page"
      (click)="nextPage()"
      [disabled]="currentPage >= totalPages">
      Suivant â†’
    </button>
  </div>
</div>
