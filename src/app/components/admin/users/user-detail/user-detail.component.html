<div class="user-detail-page">
  <!-- Header -->
  <div class="page-header">
    <button class="btn-back" routerLink="/admin/users">
      â† Retour Ã  la liste
    </button>
    <div class="header-actions">
      <button
        *ngIf="user"
        class="btn-action btn-edit"
        [routerLink]="['/admin/users', userId, 'edit']">
        âœï¸ Modifier
      </button>
      <button
        *ngIf="user"
        class="btn-action btn-toggle"
        (click)="toggleUserStatus()">
        {{ user.is_active ? 'ğŸ”’ DÃ©sactiver' : 'ğŸ”“ Activer' }}
      </button>
      <button
        *ngIf="user"
        class="btn-action btn-delete"
        (click)="deleteUser()">
        ğŸ—‘ï¸ Supprimer
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des dÃ©tails...</p>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage && !loading" class="error-container">
    <div class="error-icon">âŒ</div>
    <h2>{{ errorMessage }}</h2>
    <button class="btn-retry" (click)="loadUser()">
      ğŸ”„ RÃ©essayer
    </button>
  </div>

  <!-- User Details -->
  <div *ngIf="user && !loading" class="user-details">

    <!-- Profile Card -->
    <div class="profile-card">
      <div class="profile-header">
        <div class="profile-avatar">
          {{ user.full_name.charAt(0).toUpperCase() }}
        </div>
        <div class="profile-info">
          <h1 class="user-name">{{ user.full_name }}</h1>
          <p class="user-email">{{ user.email }}</p>
          <div class="user-badges">
            <span [class]="'role-badge ' + getRoleBadgeClass(user.role)">
              {{ getRoleIcon(user.role) }} {{ getRoleLabel(user.role) }}
            </span>
            <span [class]="'status-badge ' + (user.is_active ? 'active' : 'inactive')">
              {{ user.is_active ? 'âœ… Actif' : 'âŒ Inactif' }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Details Grid -->
    <div class="details-grid">

      <!-- Contact Information -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ“ Informations de contact</h2>
        <div class="detail-list">
          <div class="detail-item">
            <span class="detail-label">Email</span>
            <span class="detail-value">{{ user.email }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">TÃ©lÃ©phone</span>
            <span class="detail-value">{{ user.phone || 'Non renseignÃ©' }}</span>
          </div>
        </div>
      </div>

      <!-- Account Information -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ‘¤ Informations du compte</h2>
        <div class="detail-list">
          <div class="detail-item">
            <span class="detail-label">ID Utilisateur</span>
            <span class="detail-value">#{{ user.id }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">RÃ´le</span>
            <span class="detail-value">
              {{ getRoleIcon(user.role) }} {{ getRoleLabel(user.role) }}
            </span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Statut</span>
            <span [class]="'status-indicator ' + (user.is_active ? 'active' : 'inactive')">
              {{ user.is_active ? 'ğŸŸ¢ Actif' : 'ğŸ”´ Inactif' }}
            </span>
          </div>
        </div>
      </div>

      <!-- Activity Information -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ“… ActivitÃ©</h2>
        <div class="detail-list">
          <div class="detail-item">
            <span class="detail-label">CrÃ©Ã© le</span>
            <span class="detail-value">{{ formatDate(user.created_at) }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">AnciennetÃ©</span>
            <span class="detail-value">{{ getAccountAge() }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">DerniÃ¨re connexion</span>
            <span class="detail-value">{{ formatDate(user.last_login) }}</span>
          </div>
          <div class="detail-item" *ngIf="user.updated_at">
            <span class="detail-label">ModifiÃ© le</span>
            <span class="detail-value">{{ formatDate(user.updated_at) }}</span>
          </div>
        </div>
      </div>

      <!-- Permissions (based on role) -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ” Permissions</h2>
        <div class="permissions-list">
          <div *ngIf="user.role === 'ADMIN'" class="permission-item granted">
            âœ… AccÃ¨s complet administrateur
          </div>
          <div *ngIf="user.role === 'ADMIN'" class="permission-item granted">
            âœ… Gestion des utilisateurs
          </div>
          <div *ngIf="user.role === 'ADMIN'" class="permission-item granted">
            âœ… Gestion du troupeau
          </div>
          <div *ngIf="user.role === 'ADMIN'" class="permission-item granted">
            âœ… Configuration systÃ¨me
          </div>

          <div *ngIf="user.role === 'AGRONOME'" class="permission-item granted">
            âœ… Consultation du troupeau
          </div>
          <div *ngIf="user.role === 'AGRONOME'" class="permission-item granted">
            âœ… Analyse des donnÃ©es
          </div>
          <div *ngIf="user.role === 'AGRONOME'" class="permission-item granted">
            âœ… GÃ©nÃ©ration de rapports
          </div>
          <div *ngIf="user.role === 'AGRONOME'" class="permission-item denied">
            âŒ Gestion des utilisateurs
          </div>

          <div *ngIf="user.role === 'ELEVEUR'" class="permission-item granted">
            âœ… Suivi des vaches personnelles
          </div>
          <div *ngIf="user.role === 'ELEVEUR'" class="permission-item granted">
            âœ… RÃ©ception des alertes
          </div>
          <div *ngIf="user.role === 'ELEVEUR'" class="permission-item denied">
            âŒ Gestion du systÃ¨me
          </div>
        </div>
      </div>
    </div>

    <!-- Action Zone -->
    <div class="action-zone">
      <div class="action-card danger">
        <h3>âš ï¸ Zone de danger</h3>
        <p>Les actions suivantes sont irrÃ©versibles. ProcÃ©dez avec prÃ©caution.</p>
        <div class="danger-actions">
          <button class="btn-danger" (click)="toggleUserStatus()">
            {{ user.is_active ? 'ğŸ”’ DÃ©sactiver le compte' : 'ğŸ”“ Activer le compte' }}
          </button>
          <button class="btn-danger" (click)="deleteUser()">
            ğŸ—‘ï¸ Supprimer dÃ©finitivement
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
