<div class="user-list-page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-left">
      <h1>ğŸ‘¥ Gestion des Utilisateurs</h1>
      <p>{{ filteredUsers.length }} utilisateur(s) {{ selectedRole !== 'ALL' ? 'filtrÃ©(s)' : 'au total' }}</p>
    </div>
    <div class="header-actions">
      <button routerLink="/admin/users/new" class="btn-primary">
        â• Nouvel utilisateur
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-card">
    <div class="filter-group">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="filterUsers()"
        placeholder="ğŸ” Rechercher par nom ou email..."
        class="search-input"
      />
    </div>

    <div class="filter-group">
      <select [(ngModel)]="selectedRole" (change)="filterUsers()" class="role-select">
        <option value="ALL">ğŸ‘¤ Tous les rÃ´les</option>
        <option value="ADMIN">ğŸ‘¨â€ğŸ’¼ Administrateur</option>
        <option value="AGRONOME">ğŸ”¬ Agronome</option>
        <option value="ELEVEUR">ğŸ‘¨â€ğŸŒ¾ Ã‰leveur</option>
      </select>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des utilisateurs...</p>
  </div>

  <!-- Users Table -->
  <div *ngIf="!loading" class="users-table-container">
    <table class="users-table">
      <thead>
        <tr>
          <th>Utilisateur</th>
          <th>Email</th>
          <th>RÃ´le</th>
          <th>TÃ©lÃ©phone</th>
          <th>Statut</th>
          <th>Date crÃ©ation</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers" [class.inactive]="!user.is_active">
          <!-- User Info -->
          <td>
            <div class="user-cell">
              <div class="user-avatar">
                {{ user.full_name.charAt(0).toUpperCase() }}
              </div>
              <div class="user-info">
                <strong>{{ user.full_name }}</strong>
                <small *ngIf="!user.is_active">âš ï¸ Compte dÃ©sactivÃ©</small>
              </div>
            </div>
          </td>

          <!-- Email -->
          <td>{{ user.email }}</td>

          <!-- Role Badge -->
          <td>
            <span [class]="getRoleBadgeClass(user.role)" class="role-badge">
              {{ getRoleIcon(user.role) }} {{ getRoleLabel(user.role) }}
            </span>
          </td>

          <!-- Phone -->
          <td>{{ user.phone || 'â€”' }}</td>

          <!-- Status -->
          <td>
            <span class="status-badge" [class.active]="user.is_active">
              {{ user.is_active ? 'âœ… Actif' : 'âŒ Inactif' }}
            </span>
          </td>

          <!-- Created Date -->
          <td>{{ user.created_at | date: 'dd/MM/yyyy HH:mm' }}</td>

          <!-- Actions -->
          <td class="actions-cell">
            <button
              [routerLink]="['/admin/users', user.id]"
              class="btn-action view"
              title="Voir dÃ©tails">
              ğŸ‘ï¸
            </button>
            <button
              [routerLink]="['/admin/users', user.id, 'edit']"
              class="btn-action edit"
              title="Modifier">
              âœï¸
            </button>
            <button
              (click)="toggleUserStatus(user)"
              class="btn-action toggle"
              [title]="user.is_active ? 'DÃ©sactiver' : 'Activer'">
              {{ user.is_active ? 'ğŸ”’' : 'ğŸ”“' }}
            </button>
            <button
              (click)="deleteUser(user.id)"
              class="btn-action delete"
              title="Supprimer">
              ğŸ—‘ï¸
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Empty State -->
    <div *ngIf="filteredUsers.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ‘¥</div>
      <p>Aucun utilisateur trouvÃ©</p>
      <small>Essayez de modifier vos critÃ¨res de recherche</small>
    </div>
  </div>
</div>
