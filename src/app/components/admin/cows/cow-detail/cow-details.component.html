<div class="cow-detail-page">
  <!-- Header -->
  <div class="page-header">
    <button class="btn-back" routerLink="/admin/cows">
      â† Retour au troupeau
    </button>
    <div class="header-actions">
      <button
        *ngIf="cow"
        class="btn-action btn-pdf"
        (click)="exportToPDF()">
        ğŸ“„ Exporter PDF
      </button>
      <button
        *ngIf="cow"
        class="btn-action btn-edit"
        [routerLink]="['/admin/cows', cowId, 'edit']">
        âœï¸ Modifier
      </button>
      <button
        *ngIf="cow"
        class="btn-action btn-toggle"
        (click)="toggleCowStatus()">
        {{ cow.is_active ? 'ğŸ”’ DÃ©sactiver' : 'ğŸ”“ Activer' }}
      </button>
      <button
        *ngIf="cow"
        class="btn-action btn-delete"
        (click)="deleteCow()">
        ğŸ—‘ï¸ Supprimer
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Chargement des dÃ©tails...</p>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage && !loading" class="error-container">
    <div class="error-icon">âŒ</div>
    <h2>{{ errorMessage }}</h2>
    <button class="btn-retry" (click)="loadCow()">
      ğŸ”„ RÃ©essayer
    </button>
  </div>

  <!-- Cow Details -->
  <div *ngIf="cow && !loading" class="cow-details">

    <!-- Profile Card -->
    <div class="profile-card">
      <div class="profile-header">
        <div class="profile-photo">
          <img *ngIf="hasPhoto()" [src]="cow.photo_url" [alt]="cow.name" class="cow-photo" />
          <div *ngIf="!hasPhoto()" class="cow-placeholder">
            {{ getCowInitials() }}
          </div>
        </div>
        <div class="profile-info">
          <h1 class="cow-name">{{ cow.name }}</h1>
          <p class="cow-tag">ğŸ·ï¸ {{ cow.tag_id }}</p>
          <div class="cow-badges">
            <span class="breed-badge" *ngIf="cow.breed">
              ğŸ„ {{ cow.breed }}
            </span>
            <span [class]="'status-badge ' + getStatusClass()">
              {{ getStatusLabel() }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Details Grid -->
    <div class="details-grid">

      <!-- Identification -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ„ Identification</h2>
        <div class="detail-list">
          <div class="detail-item">
            <span class="detail-label">Nom</span>
            <span class="detail-value">{{ cow.name }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Tag ID (Boucle)</span>
            <span class="detail-value tag-id">{{ cow.tag_id }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Race</span>
            <span class="detail-value">{{ cow.breed || 'Non spÃ©cifiÃ©e' }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">ID SystÃ¨me</span>
            <span class="detail-value">#{{ cow.id }}</span>
          </div>
        </div>
      </div>

      <!-- CaractÃ©ristiques -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ“ CaractÃ©ristiques</h2>
        <div class="detail-list">
          <div class="detail-item">
            <span class="detail-label">Date de naissance</span>
            <span class="detail-value">{{ formatDate(cow.birth_date) }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Ã‚ge</span>
            <span class="detail-value age-value">ğŸ“… {{ getAge() }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Poids</span>
            <span class="detail-value">
              {{ cow.weight ? (cow.weight + ' kg') : 'Non renseignÃ©' }}
            </span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Statut</span>
            <span [class]="'status-indicator ' + getStatusClass()">
              {{ getStatusIcon() }} {{ cow.is_active ? 'Active' : 'Inactive' }}
            </span>
          </div>
        </div>
      </div>

      <!-- Ã‰tat de santÃ© -->
      <div class="detail-card health-card">
        <h2 class="card-title">ğŸ¥ Ã‰tat de santÃ©</h2>
        <div class="health-score-display" [ngClass]="getHealthScoreClass()">
          <div class="health-icon">{{ getHealthScoreIcon() }}</div>
          <div class="health-info">
            <div class="health-value">{{ cow.health_score }}/100</div>
            <div class="health-label">{{ getHealthScoreLabel() }}</div>
          </div>
          <div class="health-bar">
            <div class="health-progress" [style.width.%]="cow.health_score"></div>
          </div>
        </div>
      </div>

      <!-- Historique -->
      <div class="detail-card">
        <h2 class="card-title">ğŸ“… Historique</h2>
        <div class="detail-list">
          <div class="detail-item">
            <span class="detail-label">AjoutÃ©e le</span>
            <span class="detail-value">{{ formatDateTime(cow.created_at) }}</span>
          </div>
          <div class="detail-item" *ngIf="cow.updated_at">
            <span class="detail-label">DerniÃ¨re modification</span>
            <span class="detail-value">{{ formatDateTime(cow.updated_at) }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Dans le systÃ¨me depuis</span>
            <span class="detail-value">{{ getAge() }}</span>
          </div>
        </div>
      </div>

      <!-- Notes -->
      <div class="detail-card notes-card" *ngIf="cow.notes">
        <h2 class="card-title">ğŸ“ Notes et observations</h2>
        <div class="notes-content">
          {{ cow.notes }}
        </div>
      </div>

      <!-- Photo (if not already shown in profile) -->
      <div class="detail-card photo-card" *ngIf="hasPhoto()">
        <h2 class="card-title">ğŸ“· Photo</h2>
        <div class="photo-display">
          <img [src]="cow.photo_url" [alt]="cow.name" class="cow-photo-large" />
        </div>
      </div>
    </div>

    <!-- Action Zone -->
    <div class="action-zone">
      <div class="action-card danger">
        <h3>âš ï¸ Zone de danger</h3>
        <p>Les actions suivantes sont irrÃ©versibles. ProcÃ©dez avec prÃ©caution.</p>
        <div class="danger-actions">
          <button class="btn-danger" (click)="toggleCowStatus()">
            {{ cow.is_active ? 'ğŸ”’ Retirer du troupeau' : 'ğŸ”“ RÃ©intÃ©grer au troupeau' }}
          </button>
          <button class="btn-danger" (click)="deleteCow()">
            ğŸ—‘ï¸ Supprimer dÃ©finitivement
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
